{
  "dashboard": {
    "title": "Network Overview",
    "tags": ["network", "kiosk"],
    "timezone": "browser",
    "refresh": "30s",
    "time": {
      "from": "now-1h",
      "to": "now"
    },
    "panels": [
      {
        "id": 1,
        "title": "Targets Up / Down",
        "type": "stat",
        "gridPos": { "h": 4, "w": 6, "x": 0, "y": 0 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "count(up == 1)",
            "legendFormat": "Up"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "thresholds" },
            "thresholds": {
              "steps": [
                { "color": "red", "value": null },
                { "color": "green", "value": 1 }
              ]
            },
            "unit": "none"
          }
        },
        "options": {
          "colorMode": "background",
          "graphMode": "none",
          "textMode": "value_and_name",
          "reduceOptions": { "calcs": ["lastNotNull"] }
        }
      },
      {
        "id": 2,
        "title": "MikroTik Uptime",
        "type": "stat",
        "gridPos": { "h": 4, "w": 6, "x": 6, "y": 0 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "sysUpTime{instance=\"192.168.10.1:9116\"} / 100",
            "legendFormat": "CRS309"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "thresholds" },
            "thresholds": {
              "steps": [
                { "color": "green", "value": null }
              ]
            },
            "unit": "s"
          }
        },
        "options": {
          "colorMode": "background",
          "graphMode": "none",
          "reduceOptions": { "calcs": ["lastNotNull"] }
        }
      },
      {
        "id": 3,
        "title": "CPU Usage",
        "type": "gauge",
        "gridPos": { "h": 4, "w": 6, "x": 12, "y": 0 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "100 - (avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)",
            "legendFormat": "CPU"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "thresholds" },
            "thresholds": {
              "steps": [
                { "color": "green", "value": null },
                { "color": "yellow", "value": 60 },
                { "color": "red", "value": 85 }
              ]
            },
            "unit": "percent",
            "min": 0,
            "max": 100
          }
        }
      },
      {
        "id": 4,
        "title": "Memory Usage",
        "type": "gauge",
        "gridPos": { "h": 4, "w": 6, "x": 18, "y": 0 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100",
            "legendFormat": "Memory"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "thresholds" },
            "thresholds": {
              "steps": [
                { "color": "green", "value": null },
                { "color": "yellow", "value": 70 },
                { "color": "red", "value": 90 }
              ]
            },
            "unit": "percent",
            "min": 0,
            "max": 100
          }
        }
      },
      {
        "id": 5,
        "title": "Device Reachability (ICMP)",
        "type": "table",
        "gridPos": { "h": 6, "w": 12, "x": 0, "y": 4 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "probe_success{job=\"icmp-probes\"}",
            "legendFormat": "{{instance}}",
            "instant": true,
            "format": "table"
          },
          {
            "expr": "probe_duration_seconds{job=\"icmp-probes\"}",
            "legendFormat": "{{instance}}",
            "instant": true,
            "format": "table"
          }
        ],
        "fieldConfig": {
          "defaults": {},
          "overrides": [
            {
              "matcher": { "id": "byName", "options": "Value #A" },
              "properties": [
                { "id": "displayName", "value": "Status" },
                { "id": "mappings", "value": [
                  { "type": "value", "options": { "1": { "text": "UP", "color": "green" }, "0": { "text": "DOWN", "color": "red" } } }
                ]},
                { "id": "custom.cellOptions", "value": { "type": "color-background" } }
              ]
            },
            {
              "matcher": { "id": "byName", "options": "Value #B" },
              "properties": [
                { "id": "displayName", "value": "Latency" },
                { "id": "unit", "value": "s" },
                { "id": "decimals", "value": 3 }
              ]
            },
            {
              "matcher": { "id": "byName", "options": "instance" },
              "properties": [
                { "id": "displayName", "value": "Device" }
              ]
            },
            {
              "matcher": { "id": "byName", "options": "Time" },
              "properties": [{ "id": "custom.hidden", "value": true }]
            },
            {
              "matcher": { "id": "byName", "options": "__name__" },
              "properties": [{ "id": "custom.hidden", "value": true }]
            },
            {
              "matcher": { "id": "byName", "options": "job" },
              "properties": [{ "id": "custom.hidden", "value": true }]
            }
          ]
        },
        "transformations": [
          {
            "id": "merge",
            "options": {}
          }
        ]
      },
      {
        "id": 6,
        "title": "System Load (1m / 5m / 15m)",
        "type": "timeseries",
        "gridPos": { "h": 6, "w": 12, "x": 12, "y": 4 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          { "expr": "node_load1", "legendFormat": "1m" },
          { "expr": "node_load5", "legendFormat": "5m" },
          { "expr": "node_load15", "legendFormat": "15m" }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "palette-classic" },
            "custom": {
              "lineWidth": 2,
              "fillOpacity": 10,
              "showPoints": "never"
            }
          }
        }
      },
      {
        "id": 7,
        "title": "MikroTik Interface Traffic (In)",
        "type": "timeseries",
        "gridPos": { "h": 7, "w": 12, "x": 0, "y": 10 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "rate(ifHCInOctets{instance=\"192.168.10.1:9116\"}[5m]) * 8",
            "legendFormat": "{{ifName}} ({{ifDescr}})"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "palette-classic" },
            "unit": "bps",
            "custom": {
              "lineWidth": 2,
              "fillOpacity": 15,
              "showPoints": "never"
            }
          }
        }
      },
      {
        "id": 8,
        "title": "MikroTik Interface Traffic (Out)",
        "type": "timeseries",
        "gridPos": { "h": 7, "w": 12, "x": 12, "y": 10 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "rate(ifHCOutOctets{instance=\"192.168.10.1:9116\"}[5m]) * 8",
            "legendFormat": "{{ifName}} ({{ifDescr}})"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "palette-classic" },
            "unit": "bps",
            "custom": {
              "lineWidth": 2,
              "fillOpacity": 15,
              "showPoints": "never"
            }
          }
        }
      },
      {
        "id": 9,
        "title": "Disk Usage",
        "type": "bargauge",
        "gridPos": { "h": 5, "w": 12, "x": 0, "y": 17 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "(1 - (node_filesystem_avail_bytes{mountpoint=~\"/|/home\"} / node_filesystem_size_bytes{mountpoint=~\"/|/home\"})) * 100",
            "legendFormat": "{{mountpoint}}"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "thresholds" },
            "thresholds": {
              "steps": [
                { "color": "green", "value": null },
                { "color": "yellow", "value": 70 },
                { "color": "red", "value": 90 }
              ]
            },
            "unit": "percent",
            "min": 0,
            "max": 100
          }
        },
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient",
          "reduceOptions": { "calcs": ["lastNotNull"] }
        }
      },
      {
        "id": 10,
        "title": "Ping Latency",
        "type": "timeseries",
        "gridPos": { "h": 5, "w": 12, "x": 12, "y": 17 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "probe_icmp_duration_seconds{phase=\"rtt\",job=\"icmp-probes\"}",
            "legendFormat": "{{instance}}"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "palette-classic" },
            "unit": "s",
            "custom": {
              "lineWidth": 2,
              "fillOpacity": 0,
              "showPoints": "never"
            }
          }
        }
      },
      {
        "id": 11,
        "title": "Interface Errors",
        "type": "timeseries",
        "gridPos": { "h": 5, "w": 12, "x": 0, "y": 22 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "rate(ifInErrors{instance=\"192.168.10.1:9116\"}[5m])",
            "legendFormat": "{{ifName}} In Errors"
          },
          {
            "expr": "rate(ifOutErrors{instance=\"192.168.10.1:9116\"}[5m])",
            "legendFormat": "{{ifName}} Out Errors"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "palette-classic" },
            "unit": "errors/s",
            "custom": {
              "lineWidth": 2,
              "fillOpacity": 10,
              "showPoints": "never"
            }
          }
        }
      },
      {
        "id": 12,
        "title": "Host Network Traffic",
        "type": "timeseries",
        "gridPos": { "h": 5, "w": 12, "x": 12, "y": 22 },
        "datasource": { "type": "prometheus", "uid": "PBFA97CFB590B2093" },
        "targets": [
          {
            "expr": "rate(node_network_receive_bytes_total{device!=\"lo\"}[5m]) * 8",
            "legendFormat": "{{device}} RX"
          },
          {
            "expr": "rate(node_network_transmit_bytes_total{device!=\"lo\"}[5m]) * 8",
            "legendFormat": "{{device}} TX"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "palette-classic" },
            "unit": "bps",
            "custom": {
              "lineWidth": 2,
              "fillOpacity": 15,
              "showPoints": "never"
            }
          }
        }
      }
    ],
    "schemaVersion": 39
  },
  "overwrite": true
}
